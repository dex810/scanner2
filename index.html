<!DOCTYPE html>
<html>
<head>
    <title>QR Code Scanner</title>
    <script src="instascan.min.js"></script>
    <style>
        /* Your existing CSS styles */
        body { margin: 0; padding: 20px; }
        #preview { width: 100%; height: auto; }
    </style>
</head>
<body>
    <h1>QR Code Scanner</h1>
    <video id="preview"></video>
    <div id="status">Scanning...</div>

    <script>
        const scanner = new Instascan.Scanner({
            video: document.getElementById('preview'),
            mirror: false
        });

        scanner.addListener('scan', async (content) => {
            const status = document.getElementById('status');
            status.textContent = `Scanned: ${content}`;
            
            try {
                const response = await fetch('YOUR_GOOGLE_SCRIPT_URL', {
                    method: 'POST',
                    body: JSON.stringify({ qrContent: content }),
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (!response.ok) throw new Error('Failed to save');
                status.textContent += ' - Saved to Sheet!';
            } catch (error) {
                console.error(error);
                status.textContent = `Error: ${error.message}`;
            }
        });

        Instascan.Camera.getCameras()
            .then(cameras => {
                if (cameras.length > 0) {
                    scanner.start(cameras[0]);
                } else {
                    document.getElementById('status').textContent = 'No cameras found';
                }
            })
            .catch(console.error);
    </script>
</body>
</html>